<!DOCTYPE html>
<html>
<body>
<script>
    const params = new URLSearchParams(window.location.search);
    const code = params.get("code");

    if (!code) {
        document.write("Erreur : aucun code reçu.");
        throw new Error("Missing code");
    }

    localStorage.setItem("onedrive_code", code);

    document.write("OK — Vous pouvez fermer cette fenêtre.");
    window.close();
</script>
</body>
</html>
